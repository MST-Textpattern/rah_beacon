<txp:if_variable name="poster"> 
    <txp:variable 
        name="poster" 
        value='poster="<txp:variable name="poster" />"'
    />
<txp:else />
    <txp:variable 
        name="poster" 
        value=""
    />
</txp:if_variable>

<video <txp:variable name="poster" /> controls>
    <txp:php>
        foreach (do_list(parse('<txp:yield />'), n) as $source)
        {
            echo '<source src="'.txpspecialchars($source).'" />'.n;
        }
    </txp:php>
</video>